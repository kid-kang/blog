# blog

ä½ å¥½ ğŸ‘‹ï¼æ¬¢è¿æ¥åˆ°åšå®¢åˆ†äº«å¹³å°ï¼åœ¨è¿™é‡Œä½ å¯ä»¥æµè§ˆæˆ–åˆ†äº«ä¸€äº›ä½ çš„æŠ€æœ¯æ–‡ç« äº¦æˆ–æ˜¯ç¾æ–‡ç¾è¯—ï¼Œç”šè‡³å¯ä»¥åˆ†äº«ç”Ÿæ´»ä¸­çš„è¶£äº‹ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨è®¨è®ºåŒºè¯´å‡ºä½ çš„çœ‹æ³•ï¼Œåœ¨è¿™é‡Œä½ æˆ–è®¸èƒ½é‡è§ç›¸ä¼¼çš„çµé­‚...

è¯¥é¡¹ç›®å‰ç«¯ä½¿ç”¨ Vue3 + Pinia é‡æ„ [MyBlog](https://github.com/kid-kang/MyBlog) é¡¹ç›®ï¼Œä¼˜åŒ–æ€§èƒ½ï¼Œä¼˜åŒ–ç•Œé¢ã€‚

åç«¯æºç è¯·çœ‹ [blog-api](https://github.com/kid-kang/blog-api)

è¯¥å¹³å°è¯ç”Ÿäº 2021.9ï¼Œé‡æ„äº 2022.11

æ—©å°±æœ‰è¿‡é‡æ„æœ¬ç«™çš„å¿µå¤´ä½†è¿Ÿè¿Ÿæ²¡æœ‰åŠ¨æ‰‹ï¼Œè¿™æ¬¡ç»ˆäºæ’¸èµ·è¢–å­ï¼Œä½†æ˜¯é‡åˆ°çš„ç§ç§å›°éš¾è®©æˆ‘å¤œä¸èƒ½å¯ã€‚æˆ‘æƒ³ï¼Œå°±ç®—æ˜¯é€šå®µè¾¾æ—¦æˆ‘ä¹Ÿè¦å°½å¿«çš„å®Œæˆå®ƒï¼

## ä¼˜åŒ–è¯¦æƒ…

| ä¿®æ”¹æè¿°                   | æ”¹è¿›æ–¹æ¡ˆ 1                                                                             | æ”¹è¿›æ–¹æ¡ˆ 2              |
| :------------------------- | -------------------------------------------------------------------------------------- | ----------------------- |
| æ²¡æœ‰åšå‰åç«¯åˆ†ç¦»           | æ”¹æˆå‰åç«¯å®Œå…¨åˆ†ç¦»                                                                     |                         |
| Element-plus å®Œæ•´å¼•å…¥      | æŒ‰éœ€å¼•å…¥                                                                               | CDN åœ¨çº¿å¼•å…¥            |
| history æ¨¡å¼åˆ·æ–°å¯¼è‡´ 404   | æ”¹æˆå“ˆå¸Œæ¨¡å¼æˆ–ä½¿ç”¨ connect-history-api-fallback ä¸­é—´ä»¶                                 | ä½¿ç”¨ query æ¸²æŸ“å¯¹åº”ç»„ä»¶ |
| Vuex                       | Pinia                                                                                  |                         |
| ç®¡ç†åå°éœ€æ‰‹åŠ¨è¾“å…¥è·¯ç”±è¿›å…¥ | å°†å…¥å£å¯è§†åŒ–                                                                           |                         |
| å­—ä½“å¼•å…¥é›¶æ•£               | æ•´ä½“å¼•å…¥                                                                               |                         |
| åŠŸèƒ½æ•´æ”¹-æ–‡ç«               | æ–°å¢ Tabbar-å‘è¡¨æ–‡ç« ï¼Œæ–‡ç« æ–°å¢ç¼–è¾‘æŒ‰é’®å’Œå…¨å±€æœç´¢æ¡†ï¼ŒæŒ‰é’®åšæƒé™æ§åˆ¶ï¼Œç‚¹å‡»ç¼–è¾‘è¿›å…¥ç¼–è¾‘é¡µ |                         |
| åŠŸèƒ½æ•´æ”¹-ç•™è¨€              | æ”¹æˆè¯é¢˜è®¨è®ºï¼Œæ–°å¢åˆ é™¤æŒ‰é’®ï¼Œé…ç½®æƒé™                                                   |                         |
| åŠŸèƒ½æ•´æ”¹-é¦–é¡µ              | å°†å‹é“¾å’Œå…³äºå±•ç¤ºæ”¾åœ¨é¦–é¡µï¼Œæ•´æ”¹æ–‡æ¡ˆï¼Œæ»šåŠ¨æ¡å»é™¤                                         |                         |
| åŠŸèƒ½æ•´æ”¹-å‹é“¾å’Œåé¦ˆ        | æ–°å¢ 2 ä¸ªæƒé™ Tabbar- å‹é“¾ç®¡ç† - åé¦ˆæ”¶é›†                                              |                         |
| åŠŸèƒ½æ•´æ”¹-è®¿å®¢æ¨¡å—          | æ ·å¼è°ƒæ•´ï¼ŒåŠ å…¥æ¥è®¿æ—¶é—´                                                                 |                         |
| åŠŸèƒ½æ•´æ”¹-æ³¨å†Œæ¨¡å—          | æ–°å¢ æ˜µç§° ï¼Œå·¦ä¾§æ æ¿å—æ˜¾ç¤ºè‡ªå·±çš„å¤´åƒå’Œæ˜µç§°ï¼ŒåŸå†…å®¹æå–åˆ°é¦–é¡µ                           |                         |
| åŠŸèƒ½æ•´æ”¹-md æ–‡æ¡£æ’ä»¶       | md æ–‡æ¡£æ’ä»¶æ›´æ–°å¼•ç”¨æ–¹å¼                                                                |                         |
| åç«¯ç»†èŠ‚å¤„ç†               | åˆ é™¤æˆ–ä¿®æ”¹æ–‡ç« ï¼Œæ›´æ–°å¤´åƒï¼Œå°†ä»¥å‰çš„æ–‡ä»¶åˆ é™¤ï¼Œé˜²æ­¢ç§¯ç´¯è¿‡å¤šåƒåœ¾æ–‡ä»¶                       |                         |

## é‡åˆ°çš„é—®é¢˜

- ä¸ªäººä¿¡æ¯æ æ¿å— fixed æ§åˆ¶
  - ä¸€å¼€å§‹ç”¨ ç²˜æ€§å®šä½ï¼Œå‘ç°å®šä½ç›’å­çš„çˆ¶çº§ä¸æ˜¯ bodyï¼Œå†ç”¨è¿™ä¸ªæ–¹å¼å¤„ç†èµ·æ¥æ¯”è¾ƒç¹ç
  - é€šè¿‡æ„é€ äº†ä¸€ä¸ª useFixed å‡½æ•° å’Œä¸€ä¸ªç©ºçš„ div å ä½æ ‡ç­¾è§£å†³

```js
import {onMounted, ref} from 'vue';

export function useFixed() {
  let isFixed = ref(false);

  onMounted(() => {
    window.addEventListener('scroll', () => {
      let top = document.documentElement.scrollTop;
      if (top > 0) isFixed.value = true;
      else isFixed.value = false;
    });
  });

  return isFixed;
}
```

- åç«¯ è®¾ç½® cookie çš„æ—¶å€™ userInfo ä¸­æœ‰ä¸­æ–‡-å¯¼è‡´ cookie è®¾ç½®ä¸æˆåŠŸ
  - encodeURIComponent() å†™ cookie æ—¶ä¸èƒ½å‡ºç°ä¸­æ–‡ï¼Œéœ€è¦è¿›è¡Œ URI ç¼–ç 
  - å“åº”ä¹‹å‰ç”¨ decodeURIComponent() è§£ç 
- el-form ç»„ä»¶çš„ :model å±æ€§ç»‘å®šçš„æ˜¯ç›´æ¥çš„è¡¨å•å¯¹è±¡ï¼Œä¸èƒ½æ˜¯å¯¹åµŒå¥—çš„å¯¹è±¡
- æ— æ³•åœ¨ router.js å’Œ axios.jsï¼ˆç­‰å¤–éƒ¨ js æ–‡ä»¶ï¼‰é‡Œä½¿ç”¨ piniaï¼ŒåŸå› æ˜¯å¤–éƒ¨ js æ–‡ä»¶åœ¨ pinia å®ä¾‹åŒ–ä¹‹å‰è§£æï¼Œä»è€Œè·å–ä¸åˆ° pinia çš„ store å®ä¾‹å¯¹è±¡ã€‚åº”è¯¥æ˜¯ vue3 å¾…å†³è§£çš„ä¸€ä¸ªé—®é¢˜ã€‚ç›®å‰æ²¡æœ‰æ‰¾åˆ°ç»å¯¹æœ‰æ•ˆçš„æ–¹å¼è§£å†³ã€‚
  - æ‰€ä»¥æˆ‘çš„è·¯ç”±å®ˆå«æ”¹æˆå°è£… onBeforeMount çš„æ–¹å¼è§£å†³
- æœªçŸ¥åŸå› ï¼šrouter è¦å®šä¹‰åœ¨ use å†…æ‰ç”Ÿæ•ˆï¼Œstore å°±ä¸éœ€è¦ã€‚

```js
import {ElMessage} from 'element-plus';
import {useBlogStore} from '@/store';
import {onBeforeMount} from 'vue';
import {useRouter} from 'vue-router';
const store = useBlogStore();

export function useRedirect(isAdminPages) {
  const router = useRouter(); //æœªçŸ¥åŸå›  routerè¦å®šä¹‰åœ¨useå†…æ‰ç”Ÿæ•ˆï¼Œstore å°±ä¸éœ€è¦ã€‚

  onBeforeMount(() => {
    if (isAdminPages && !store.userInfo.admin) {
      ElMessage.error('æ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™');
      router.replace('/');
    } else if (!store.userInfo.name) {
      ElMessage.error('è¯·ç™»å½•åæ“ä½œï¼');
      router.replace('/');
    }
  });
}
```
- `<el-form :model="dialogFormData" :rules="rules">` ä¸­çš„modelå±æ€§ä¸èƒ½åµŒå¥—ï¼Œä¸ç„¶å¯èƒ½ä¼šç»‘å®šä¸åˆ°

## Project Setup

```sh
npm install
```

### Compile and Hot-Reload for Development

```sh
npm run dev
```

### Compile and Minify for Production

```sh
npm run build
```
